<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.1.9/lib/p5.js"></script>
    <script src="globals.js"></script>
    <script src="fileLoading.js"></script>
    <script src="promiseData.js"></script>
    <script src="AntiPattern.js"></script>
    <script src="Widgets/VisTextWidget.js"></script>
    <script src="panel.js"></script>
    <script src="Widgets/ButtonWidget.js"></script>
    <script src="Widgets/HoverButtonWidget.js"></script>
    <script src="Widgets/SearchBoxWidget.js"></script>
    <script src="entity.js"></script>
    <script src="barchart.js"></script>
    <script src="Controls.js"></script>
    <script src="UI.js"></script>
    <script src="sketch.js"></script>
    <!-- Style sheet -->
    <link rel="stylesheet" href="style.css">

    <!-- Third party libraries -->
    <script src="./thirdparty/prism.js"></script>
    <link href="./thirdparty/prism.css" rel="stylesheet" />

    <script src="./thirdparty/jquery-3.5.1.slim.min.js"></script>
    
    <script type="text/javascript" src="http://getbootstrap.com/2.3.2/assets/js/bootstrap.js"></script>
    <link rel="stylesheet" type="text/css" href="http://getbootstrap.com/2.3.2/assets/css/bootstrap.css">

<script type="text/javascript">
  let g_SelectedTextInTextBox = "";

    // If 'mode' is true we find the first selected text
    // If 'mode' is false we find the last selected text
    function GotoSelectedText(mode) {
      var selObj = window.getSelection();
      g_SelectedTextInTextBox = selObj.getRangeAt(0).toString();
      console.log(g_SelectedTextInTextBox);
      
      document.getElementById('searchedText').value = g_SelectedTextInTextBox;
      alert("Looking for:"+g_SelectedTextInTextBox); // Uncomment to debug
      // do stuff with the range
      searchAndGoToSelectedText(mode);
    }
</script>

  </head>
  
  <body>
    <table>
        <tr>
            <td valign="top">
                <!--  
                      Note that main is at the top of
                      the screen because it makes it easy to 
                      check the bounds of the mouse and ignore
                      mouse events that happen outside of the
                      visualization

                      Start p5 Sketch
                -->
                <main>
                </main>
            </td>
            <td valign="top">
                <p></p>
                  <h3>Selected Promise contents:</h3>
                  <div id="searchTools">
                    <button onclick="GotoSelectedText(true);">Find First Selected Text in Visualization</button>
                    <button onclick="NextSelected();">Find Next</button>
                    <button onclick="PreviousSelected();">Find Previous</button>
                    <button onclick="GotoSelectedText(false);">Find Last Selected Text in Visualization</button>
                    <button onclick="FindAllInstancesOfSelectedText();">Find & Select All Instances</button>

                    <div>
                        <textarea id="searchedText" name="searchedText" rows="4" cols="500" style="width: 700px;" readonly>
                        </textarea>
                    </div>
                  </div>
                    <div class="tab" id="tabController">
                      <button class="tablinks" onclick="viewFile(event, 'PromiseBrowser')" id="defaultOpen">PromiseBrowser</button>
                      <button class="tablinks" onclick="viewFile(event, 'AntiPatternBrowser')">AntiPatternBrowser</button>
                    </div>
                    <div id="listOfOpenFiles">
                      <div id="PromiseBrowser" class="tabcontent">
                        <pre id="promisePre" class="line-numbers" data-line="1-1">
<!--                   --><code id="output" class="language-javascript">// .js code will show up here if a source file exists</code>
                        </pre>
                      </div>
                    </div>
                    <div id="listOfOpenFiles">
                      <div id="AntiPatternBrowser" class="tabcontent">
                        <pre id="promisePre" class="line-numbers" data-line="1-1">
<!--                   --><code id="output" class="language-javascript">// .js code will show up here if a source file exists</code>
                        </pre>
                      </div>
                    </div>
                </p>
            </td>
        </tr>
        

    </table>


    <!-- Other information 
    -->
    <h1>Visualizing Promises P5.js Visualization</h1> 

    <table>
      <tr>
        <td>
          <div>
            <h2>Controls:</h2>
            <ul>
                <li>Press 'r' to reset the view</li>
                <li>mouse-scroll with center button to zoom in/out</li>
                <li>Middle-Click and hold mouse to pan</li>
                <li>Click on nodes to highlight them.</li>
                <li>Left-click in the mini-display and click to scroll to a location</li>
                <li>GUI Panel interaction
                  <ul>
                    <li>Middle-click to move panels around</li>
                    <li>Left-click on panels to</li>
                  </ul>
                </li>

            </ul>
        </div>
        </td>
        <td>
          <div>
            <h2>Todo list</h2>
            <ul>
              <li>Zoom to cursor</li>
              <li>Abstract UI to class</li>
              <li>Save result to URL</li>
              <li>Open multiple files in tabs at once</li>
              <li>Ability to load different data sets</li>
              <li>Ranged Selection by clicking and dragging and releasing</li>
              <li>Export or filter selection by View</li>
              <li>Select different color schemes</li>
              <li>Ignore events(i.e. mouse scrolling) if it doesn't happen over canvas</li>
              <li>Need to frame view to fit selection</li>
              <li>Need ability to filter or collapse nodes</li>
              <li>filter by time, filter by node_modules, filter out tests</li>
              <li>Select source and find promise</li>
            </ul>
          </div>
        </td>
      </tr>

    </table>

    Patterns: testrunner(one long running promise with many smaller promises), airplane, sequential (completely sequential)

    <script>
// For loading default tab.
document.getElementById("defaultOpen").click();
    </script>

  </body>
</html>



